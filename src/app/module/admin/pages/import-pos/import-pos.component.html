<div class="bg-gray-100 min-h-screen p-8 font-sans">
  <div class="max-w-6xl mx-auto bg-white rounded-2xl shadow-lg p-8">
    <h2 class="text-xl font-bold text-center text-indigo-700 mb-6">
      ðŸ“¦ Import Purchase Orders
    </h2>

    <!-- Step 1: Upload -->
    <div class="mb-6">
      <P class="text-xl font-bold text-gray-700 mb-2"
        >Upload File

        <!-- File Upload Box --></P
      >
      <label
        for="csv-file"
        class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition"
      >
        <div class="flex flex-col items-center justify-center pt-5 pb-6">
          <svg
            class="w-8 h-8 mb-4 text-gray-500"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 20 16"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 
             5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 
             0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"
            />
          </svg>
          <p class="mb-2 text-sm text-gray-500">
            <span class="font-semibold">Click to upload</span> or drag and drop
          </p>
          <p class="text-xs text-gray-500">XLSX files only.</p>
        </div>

        <input
          [disabled]="!enableUpload"
          class="disabled:cursor-not-allowed"
          #csvFile
          (change)="onFileSelected($event)"
          id="csv-file"
          type="file"
          class="hidden"
          accept=".xlsx"
        />
      </label>

      <!-- File name display -->
      <div
        *ngIf="selectedFileName"
        class="mt-3 flex items-center gap-2 text-sm text-green-700 bg-green-50 border border-green-200 px-3 py-2 rounded-md"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5 text-green-600"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 13l4 4L19 7"
          />
        </svg>
        <span>{{ selectedFileName }}</span>
      </div>

      <!-- Error message -->
      <div
        *ngIf="errorMessage"
        class="text-red-600 mt-2 text-sm bg-red-50 border border-red-200 px-3 py-2 rounded-md"
      >
        {{ errorMessage }}
      </div>

      <!-- Upload Progress -->
      <div *ngIf="isUploading" class="mt-4">
        <div class="text-blue-600 mb-2 text-sm">{{ uploadStatus }}</div>
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
    </div>

    <!-- Step 2: Preview -->
    <!-- <div *ngIf="groupedData?.length" class="mt-8">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">Step 2: Preview Data</h2>
      <div class="overflow-auto border rounded-lg shadow-sm">
        <table class="min-w-full text-sm text-gray-600">
          <thead class="bg-gray-50 border-b">
            <tr>
              <th class="p-3 text-left">PO Number</th>
              <th class="p-3 text-left">Customer</th>
              <th class="p-3 text-left">Supplier</th>
              <th class="p-3 text-left">Order Date</th>
              <th class="p-3 text-left">Total Amount</th>
              <th class="p-3 text-left">Items Count</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let po of groupedData"
              class="border-b hover:bg-gray-50 cursor-pointer"
              (click)="selectPo(po)"
            >
              <td class="p-3 font-medium text-indigo-600">{{ po.poNumber }}</td>
              <td class="p-3">{{ po.customerName }}</td>
              <td class="p-3">{{ po.supplier }}</td>
              <td class="p-3">{{ po.orderDate | date }}</td>
              <td class="p-3">{{ po.totalAmount | currency:'INR' }}</td>
              <td class="p-3">{{ po.items?.length }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Expand selected PO items -->
    <!-- <div *ngIf="selectedPo" class="mt-6 bg-gray-50 p-4 rounded-lg shadow-inner">
        <h3 class="text-lg font-semibold text-gray-800 mb-3">
          Items for PO: {{ selectedPo.poNumber }}
        </h3>
        <div class="overflow-auto">
          <table class="min-w-full text-sm text-gray-600 border">
            <thead class="bg-gray-200">
              <tr>
                <th class="p-2">Description</th>
                <th class="p-2">Part #</th>
                <th class="p-2">Qty</th>
                <th class="p-2">Unit</th>
                <th class="p-2">Unit Price</th>
                <th class="p-2">Total</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of selectedPo.items" class="border-b">
                <td class="p-2">{{ item.description }}</td>
                <td class="p-2">{{ item.partNumber }}</td>
                <td class="p-2">{{ item.quantity }}</td>
                <td class="p-2">{{ item.unit }}</td>
                <td class="p-2">{{ item.unitPrice | currency:'INR' }}</td>
                <td class="p-2">{{ item.totalPrice | currency:'INR' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div> -->
    <!-- response -->

    <!-- Step 3: Actions -->
    <div class="flex justify-center items-center gap-4 mt-8">
      <!-- <button
        (click)="validateData()"
        class="bg-yellow-500 hover:bg-yellow-600 text-white px-5 py-2 rounded-lg shadow"
      >
        Validate Data
      </button> -->
      <button
        [disabled]="!buttonActive"
        (click)="importData()"
        class="bg-green-600 w-[50%] hover:bg-green-700 disabled:cursor-not-allowed disabled:bg-green-500 text-white px-5 py-2 rounded-lg shadow"
      >
        Upload
      </button>
    </div>

    <!-- Status -->
    <!-- <div *ngIf="uploadStatus" class="mt-6 text-center text-green-700 font-medium">
       {{ uploadStatus }}
    </div> -->
  </div>
  <div
    *ngIf="responseData?.length"
    class="max-w-6xl mx-auto bg-white rounded-2xl shadow-lg p-8 mt-5"
  >
    <p class="text-xl font-bold text-gray-700 mb-4">Import Summary</p>
    <div class="overflow-auto border rounded-lg shadow-sm">
      <table class="min-w-full h-[50%] overflow-auto text-sm text-gray-600">
        <thead class="bg-gray-50 border-b">
          <tr>
            <th class="p-3 text-left">PO Number</th>
            <th class="p-3 text-left">Customer</th>
            <th class="p-3 text-left">Supplier</th>
            <th class="p-3 text-left">Order Date</th>
            <th class="p-3 text-left">Total Amount</th>
            <th class="p-3 text-left">Items Count</th>
            <th class="p-3 text-left">Status</th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let po of responseData"
            class="border-b hover:bg-gray-50 cursor-pointer"
            (click)="selectPo(po)"
          >
            <td class="p-3 font-medium text-indigo-600">
              {{ po.purchaseOrder.poNumber }}
            </td>
            <td class="p-3">{{ po.purchaseOrder.customerName }}</td>
            <td class="p-3">{{ po.purchaseOrder.supplier }}</td>
            <td class="p-3">{{ po.purchaseOrder.orderDate | date }}</td>
            <td class="p-3">
              {{ po.purchaseOrder.totalAmount | currency : "INR" }}
            </td>
            <td class="p-3">{{ po.purchaseOrder.items?.length }}</td>
            <td class="p-3 flex">
              <svg
                *ngIf="po.status == 'Success'"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="w-6 h-6 fill-green-400"
              >
                <path
                  fill-rule="evenodd"
                  d="M19.916 4.626a.75.75 0 01.208 1.04l-9 13.5a.75.75 0 01-1.154.114l-6-6a.75.75 0 011.06-1.06l5.353 5.353 8.493-12.739a.75.75 0 011.04-.208z"
                  clip-rule="evenodd"
                />
                Success
              </svg>

              <svg
                *ngIf="po.status == 'Failed'"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="w-6 h-6 fill-red-400"
              >
                <path
                  fill-rule="evenodd"
                  d="M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z"
                  clip-rule="evenodd"
                />
              </svg>
              <span>Failed ({{ po.reason }})</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Expand selected PO items -->
    <!-- <div *ngIf="selectedPo" class="mt-6 bg-gray-50 p-4 rounded-lg shadow-inner">
        <h3 class="text-lg font-semibold text-gray-800 mb-3">
          Items for PO: {{ selectedPo.poNumber }}
        </h3>
        <div class="overflow-auto">
          <table class="min-w-full text-sm text-gray-600 border">
            <thead class="bg-gray-200">
              <tr>
                <th class="p-2">Description</th>
                <th class="p-2">Part #</th>
                <th class="p-2">Qty</th>
                <th class="p-2">Unit</th>
                <th class="p-2">Unit Price</th>
                <th class="p-2">Total</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of selectedPo.items" class="border-b">
                <td class="p-2">{{ item.description }}</td>
                <td class="p-2">{{ item.partNumber }}</td>
                <td class="p-2">{{ item.quantity }}</td>
                <td class="p-2">{{ item.unit }}</td>
                <td class="p-2">{{ item.unitPrice | currency:'INR' }}</td>
                <td class="p-2">{{ item.totalPrice | currency:'INR' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div> -->
  </div>
</div>
